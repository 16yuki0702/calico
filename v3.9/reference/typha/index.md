---
title: Typha Overview
redirect_from: latest/reference/typha/index
canonical_url: 'https://docs.projectcalico.org/v3.9/reference/typha/index'
---

The Typha daemon sits between the datastore (such as the Kubernetes API server) and many instances of Felix. Typha's main purpose is to increase scale by reducing each node's impact on the datastore.  Services such as [Felix](https://github.com/projectcalico/felix) and [confd](https://github.com/projectcalico/confd) connect to Typha instead of connecting directly to the datastore as Typha maintains a single datastore connection on behalf of all its clients. It caches the datastore state and dedupes events so it can be fanned out to many listeners.

> **Note**: It is recommend to only use Typha if you're using the Kubernetes API Datastore and you have more than 50 Kubernetes nodes. While Typha can be used with etcd, etcd v3 is optimised to handle many clients already so we do not recommend adding Typha if you're using etcd.
{: .alert .alert-info}

## Architecture
- Typha uses the shared [libcalico-go](https://github.com/projectcalico/libcalico-go) datastore sync APIs, which [Felix](https://github.com/projectcalico/felix) and [confd](https://github.com/projectcalico/confd) can also use directly.
- It caches a series of snapshots of the datastore state along with deltas between the snapshots.
- Snapshots are stored in an immutable datastructure that shares common data with the previous snapshot.  This allows many snapshots to be stored without taking up a lot of memory.
- Felix/confd connect over an internal gob API, which sends serialised update messages.
- When a new client connects, Typha sends a series of updates calculated from the current snapshot, then it follows the deltas from snapshot to snapshot, sending them to the client.
- Typha brings a large increase in scale, particularly in Kubernetes API Datastore mode, because it can filter out many datastore events that are not required for Calico.

### Advantages
- Since one Typha instance can support hundreds of Felix instances, it reduces the load on the datastore by a large factor.
- Since Typha can filter out updates that are not relevant to Felix, it also reduces Felix's CPU usage. In a high-scale (100+ node) Kubernetes cluster, this is essential because the number of updates generated by the API server scales with the number of nodes.
